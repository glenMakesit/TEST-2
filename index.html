<!DOCTYPE html>
<html>
<head>
    <title>Baby Crib Monitor</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</head>
<body>
    <h1>Real-Time Monitoring</h1>

    <!-- Sensor Data -->
    <div>
        <p>Temperature: <span id="temperature">--</span> Â°C</p>
        <p>Distance: <span id="distance">--</span> cm</p>
        <p>LED: <span id="ledState">--</span></p>
        <p>Mode: <span id="mode">--</span></p>
    </div>

    <!-- Controls -->
    <button onclick="toggleLED()">Toggle LED</button>
    <button onclick="toggleMode()">Toggle Manual/Auto</button>

    <script>
        // Initialize Firebase (use YOUR config from Firebase Console)
        const firebaseConfig = {
            apiKey: "AIzaSyC_hE2Q4WNOFK-QPedmCrtB1T64Jxl5d3c",
            databaseURL: "https://test-2-baby-crib-default-rtdb.asia-southeast1.firebasedatabase.app/",
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Real-Time Data Listener
        db.ref("/latest").on("value", (snapshot) => {
            const data = snapshot.val();
            document.getElementById("temperature").textContent = data.temperature;
            document.getElementById("distance").textContent = data.distance;
        });

        // Control Listeners
        db.ref("/controls").on("value", (snapshot) => {
            const controls = snapshot.val();
            document.getElementById("ledState").textContent = controls.led_state ? "ON" : "OFF";
            document.getElementById("mode").textContent = controls.manual_mode ? "Manual" : "Auto";
        });

        // Control Functions
        function toggleLED() {
            const currentState = document.getElementById("ledState").textContent === "ON";
            db.ref("/controls/led_state").set(!currentState);
        }

        function toggleMode() {
            const currentMode = document.getElementById("mode").textContent === "Manual";
            db.ref("/controls/manual_mode").set(!currentMode);
        }
    </script>
</body>
</html>